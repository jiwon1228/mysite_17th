<html layout:decorate="~{layout}">
<div layout:fragment="content">
	<div class="container">
		<div class="jumbotron">
			<div class="display-4">
				<small><span class="small">ì§ˆë¬¸ ì œëª© : </span>[[${question.subject}]]</small>
			</div>
		</div>

		<div class="card bg-warning">
			<div class="card-body ">
				<h5 class="card-title text-white"><span class="small">ì§ˆë¬¸ë‚´ìš©  : </span>[[${question.content}]]
							
							<!-- ë“±ë¡ë‚ ì§œ -->
							<span class="badge badge-pill badge-secondary float-right" th:text="${#temporals.format(question.createDate, 'ë“±ë¡ë‚ ì§œ yyyy-MM-dd HH:mm')}"></span>
							<!-- ìˆ˜ì •ë‚ ì§œ -->
							<span class="badge badge-pill badge-secondary float-right mr-2" th:text="${#temporals.format(question.modifyDate, 'ìˆ˜ì •ë‚ ì§œ yyyy-MM-dd HH:mm')}"></span>
							<span class="badge badge-pill badge-secondary float-right mr-2" th:if="${question.author != null}">[[${question.author.username}]]</span>
						</h5>
			</div>
		</div>
		
		<!-- ì¢‹ì•„ìš” -->
		<a href="javascript:void(0);" class="btn btn-outline-primary mt-2 recommend" th:data-uri="@{|/question/vote/${question.id}|}" >ğŸ‘ì¢‹ì•„ìš” <span class="badge badge-pill badge-primary">[[${#lists.size(question.voter)}]]</span></a>
		<!-- ì§ˆë¬¸ ìˆ˜ì • ë²„íŠ¼ -->
		<a th:href="@{|/question/modify/${question.id}|}" class="btn btn-success mt-2" 
		   sec:authorize="isAuthenticated()" 
		   th:if="${question.author != null and #authentication.getPrincipal().getUsername() == question.author.username}">
		   ì§ˆë¬¸ ìˆ˜ì •
		</a>

		<!-- ì§ˆë¬¸ ì‚­ì œ ë²„íŠ¼ -->
		<a href="javascript:void(0);" th:data-uri="@{|/question/delete/${question.id}|}" class="delete btn btn-danger mt-2" 
		   sec:authorize="isAuthenticated()" 
		   th:if="${question.author != null and #authentication.getPrincipal().getUsername() == question.author.username}">
		   ì§ˆë¬¸ ì‚­ì œ
		</a>

		<h4 class="my-5 border-bottom py-2"
			th:text="|${#lists.size(question.answerList)}ê°œì˜ ë‹µë³€ì´ ìˆìŠµë‹ˆë‹¤.|"></h4>

		<div>
			<ul class="list-unstyled">
				<div class="card bg-light my-3"
					th:each="answer : ${question.answerList}">
					<!-- ì•µì»¤ê¸°ëŠ¥ -->
					<a th:id="|answer_${answer.id}|"></a>
					<div class="card-body">
						<li>[[${answer.content}]]</li>
		
						<!-- ë‹µë³€ë‚ ì§œë¥¼ ì¶œë ¥í•˜ëŠ” ë°°ì°Œ  -->
						<div class="d-flex justify-content-end">
							<span class="badge badge-pill badge-success mr-2" th:if="${answer.author != null}">[[${answer.author.username}]]</span>
							<!-- ìˆ˜ì •ë‚ ì§œ -->
							<span class="badge badge-pill badge-secondary float-right mr-2" th:text="${#temporals.format(answer.modifyDate, 'ìˆ˜ì •ë‚ ì§œ yyyy-MM-dd HH:mm')}"></span>
							<!-- ë“±ë¡ ë‚ ì§œ -->
							<span class="badge badge-pill badge-secondary"
								th:text="${#temporals.format(answer.createDate, 'ë“±ë¡ë‚ ì§œ yyyy-MM-dd HH:mm')}"></span>
						</div>
							<div>
					<!-- ë‹µë³€ì„ ìˆ˜ì •í•˜ëŠ” ë²„íŠ¼ -->
								<div class="mt-3">
									<!-- ì¢‹ì•„ìš” -->
									<!-- #lists:íƒ€ì„ë¦¬í”„ì˜ í™•ì¥ë¬¸ë²•ìœ¼ë¡œ íƒ€ì„ë¦¬í”„ì—ì„œ ì œê³µí•˜ëŠ” ìœ í‹¸ë¦¬í‹° ê°ì²´ë¥¼ í‘œí˜„í•˜ëŠ” ë¬¸ë²•ì´ë‹¤. #dates,#strings,#numbers,#maps ì´ëŸ° íƒ€ì…ì˜ ë‹¤ì–‘í•œ ê°ì²´ë“¤ì˜ ë‹¤ì–‘í•œ ë©”ì†Œë“œë¥¼ ì‚¬ìš© ê°€ëŠ¥í•˜ë‹¤ -->
									<a href="javascript:void(0);" class="btn btn-outline-primary recommend" th:data-uri="@{|/answer/vote/${answer.id}|}" >ğŸ‘ì¢‹ì•„ìš” <span class="badge badge-pill badge-primary">[[${#lists.size(answer.voter)}]]</span></a>
									<!-- ë‹µë³€ìˆ˜ì • -->
									<a th:href="@{|/answer/modify/${answer.id}|}" class="btn btn-success" sec:authorize="isAuthenticated()" th:if="${answer.author != null and #authentication.getPrincipal().getUsername() == answer.author.username}" th:text="ë‹µë³€ìˆ˜ì •"></a>
									<!-- ë‹µë³€ì‚­ì œ -->
									<a href="javascript:void(0);" th:data-uri="@{|/answer/delete/${answer.id}|}" class="btn btn-danger delete" sec:authorize="isAuthenticated()" th:if="${answer.author != null and #authentication.getPrincipal().getUsername() == answer.author.username}" th:text="ë‹µë³€ì‚­ì œ"></a>

								</div>
						</div>
					</div>
				</div>
			</ul>
		</div>
		
		<!-- ë‹µë³€ ì‘ì„± -->
		<form th:action="@{|/answer/create/${question.id}|}" method="post" th:object="${answerForm}">
			<!-- ìœ íš¨ì„±ê²€ì¦ errorì‹œ ì¶œë ¥ë˜ëŠ” êµ¬ë¬¸ -->
			<div th:replace="~{form_errors :: formErrorsFragment}"></div>
	
			<div class="form-group">
				<!-- ë‹µë³€ ê¸°ëŠ¥ì˜ content í•­ëª©ë„ th:field ì†ì„±ì„ ì‚¬ìš©í•˜ê² ë‹¤ëŠ” ì˜ë¯¸ë¡œ th:field*{content}ë¥¼ ë„£ëŠ”ë‹¤. -->
				<!-- isAnonymous() ë¡œê·¸ì¸ì´ ì•ˆëœ ìƒíƒœ isAuthenticated() ë¡œê·¸ì¸ì´ ëœ ìƒíƒœ -->
				<textarea sec:authorize="isAnonymous()" th:field="*{content}" class="form-control" name="content" id="content" cols="30"
					rows="10" disabled placeholder="ë¡œê·¸ì¸ í•œ ìƒíƒœì—ì„œ ë‹µë³€ ì‘ì„± ê°€ëŠ¥í•©ë‹ˆë‹¤."></textarea>
				<textarea sec:authorize="isAuthenticated()" th:field="*{content}" class="form-control" name="content" id="content" cols="30"
					rows="10"></textarea>
			</div>
			<input class="btn btn-warning p-2" type="submit" value="ë‹µë³€ ë“±ë¡í•˜ê¸°" />
		</form>
	</div>
</div>

<script layout:fragment="script" type="text/javascript">
   // ì‚­ì œ ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸ ì²˜ë¦¬
    const delete_elements = document.getElementsByClassName("delete");
    Array.from(delete_elements).forEach(function(element){
        element.addEventListener("click", function() {
            if (confirm("ì •ë§ë¡œ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) {
                location.href = this.dataset.uri;
            }
        });
    });

    // ì¶”ì²œ ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸ ì²˜ë¦¬
	const recommend_elements = document.getElementsByClassName("recommend");
		Array.from(recommend_elements).forEach(function(element){
			element.addEventListener("click",function(){
				if(confirm("ì •ë§ë¡œ ì¶”ì²œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")){
					location.href=this.dataset.uri;
				}
			})
		})
</script>
</html>
